(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48307,       1425]
NotebookOptionsPosition[     47241,       1384]
NotebookOutlinePosition[     47624,       1401]
CellTagsIndexPosition[     47581,       1398]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Schrodinger problem and Sturm-Liouville ", "Section",
 CellChangeTimes->{{3.749214988375918*^9, 3.7492150002617407`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "@", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", " ", "=", " ", "Null"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "xAct`xPert`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "xAct`xPand`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"<<", "xAct`SplitExpression`"}], "\.1d"}], " ", ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "a", " ", "5", "d", " ", "manifold", " ", "M"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefManifold", "[", 
    RowBox[{"M", ",", "5", ",", 
     RowBox[{"{", 
      RowBox[{
      "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "m", ",", "n", ",", 
       "p", ",", "q", ",", "s", ",", "t"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "We", " ", "also", " ", "define", " ", "a", " ", "metric", " ", "on", " ",
      "this", " ", "manifold"}], ",", 
    RowBox[{
    "with", " ", "negative", " ", "determinant", " ", "and", " ", 
     "associated", " ", "covariant", " ", "derivative", " ", 
     RowBox[{"CD", ".", "This"}], " ", "derivative", " ", "is", " ", 
     "extended", " ", "to", " ", "act", " ", "on", " ", "tensor", " ", 
     "densities", " ", "defined", " ", "using", " ", "the", " ", 
     "determinant", " ", "of", " ", "the", " ", "metric", " ", "g", " ", "in",
      " ", "the", " ", "basis", " ", 
     RowBox[{"AIndex", ":"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefMetric", "[", 
   RowBox[{
    RowBox[{"-", "1"}], ",", 
    RowBox[{"g", "[", 
     RowBox[{
      RowBox[{"-", "m"}], ",", 
      RowBox[{"-", "n"}]}], "]"}], ",", "CD", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<;\>\"", ",", "\"\<\[Del]\>\""}], "}"}], ",", 
    RowBox[{"WeightedWithBasis", "\[Rule]", "AIndex"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefParameter", "[", "z", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Use", " ", "the", " ", "same", " ", "notation", " ", "as", " ", 
    "Alfonso"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$CovDFormat", "=", "\"\<Prefix\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Because", " ", "we", " ", "shall", " ", "work", " ", "with", " ", "a", 
     " ", "single", " ", "covariant", " ", "derivative", " ", "operator"}], 
    ",", 
    RowBox[{
    "we", " ", "can", " ", "choose", " ", "a", " ", "simpler", " ", "output", 
     " ", "for", " ", "the", " ", "geometric", " ", "tensors"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "RiemannCD", "]"}], "^=", "\"\<R\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "RicciCD", "]"}], "^=", "\"\<R\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "RicciScalarCD", "]"}], "^=", "\"\<R\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", "ChristoffelCD", "]"}], "^=", 
   "\"\<\[CapitalGamma]\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrintAs", "[", "EinsteinCD", "]"}], "^=", "\"\<G\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"define", " ", "a", " ", "scalar", " ", 
    RowBox[{"tensor", ":", " ", 
     RowBox[{"the", " ", "tachyon", " ", "field"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefTensor", "[", 
    RowBox[{
     RowBox[{"TT", "[", "]"}], ",", "M", ",", " ", 
     RowBox[{"PrintAs", "\[Rule]", "\"\<\[Tau]\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"dilaton", " ", "field"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefTensor", "[", 
    RowBox[{
     RowBox[{"\[CapitalPhi]", "[", "]"}], ",", "M"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "the", " ", "warp", " ", "factor", " ", "as", " ", "a", " ",
     "order", " ", "zero", " ", "tensor"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefTensor", "[", 
    RowBox[{
     RowBox[{"A", "[", "]"}], ",", "M"}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "colour", " ", "in", " ", "blue", " ", "the", " ", "perturbative", " ", 
    "orders"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "IndexForm", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IndexForm", "[", 
    RowBox[{"LI", "[", "x_", "]"}], "]"}], ":=", 
   RowBox[{"ColorString", "[", 
    RowBox[{
     RowBox[{"ToString", "[", "x", "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Protect", "[", "IndexForm", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"splitting", " ", "code"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefManifold", "[", 
   RowBox[{"flat", ",", "4", ",", 
    RowBox[{"{", 
     RowBox[{
     "\[Mu]", ",", "\[Nu]", ",", "\[Rho]", ",", "\[Sigma]", ",", 
      "\[Lambda]"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefMetric", "[", 
   RowBox[{
    RowBox[{"-", "1"}], ",", 
    RowBox[{"\[Eta]", "[", 
     RowBox[{
      RowBox[{"-", "\[Mu]"}], ",", 
      RowBox[{"-", "\[Nu]"}]}], "]"}], ",", "CDflat", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<|\>\"", ",", "\"\<\[ScriptCapitalD]\>\""}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]", "/:", 
    RowBox[{
     RowBox[{"PD", "[", "_", "]"}], "[", 
     RowBox[{"\[Eta]", "[", "__", "]"}], "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"explicit", " ", "set", " ", "the", " ", "non"}], "-", 
    RowBox[{
    "z", " ", "dependence", " ", "of", " ", "A", " ", "and", " ", 
     "\[CapitalPhi]", " ", "to", " ", "improve", " ", "computations"}]}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "/:", 
   RowBox[{
    RowBox[{
     RowBox[{"PD", "[", 
      RowBox[{"p_", "|", 
       RowBox[{"-", "p_"}]}], "]"}], "[", 
     RowBox[{"A", "[", "]"}], "]"}], "/;", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"IndicesOfVBundle", "@", 
       RowBox[{"VBundleOfMetric", "[", "\[Eta]", "]"}]}], ",", "p", ",", 
      "Infinity"}], "]"}]}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TT", "/:", 
   RowBox[{
    RowBox[{
     RowBox[{"PD", "[", 
      RowBox[{"p_", "|", 
       RowBox[{"-", "p_"}]}], "]"}], "[", 
     RowBox[{"TT", "[", "]"}], "]"}], "/;", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"IndicesOfVBundle", "@", 
       RowBox[{"VBundleOfMetric", "[", "\[Eta]", "]"}]}], ",", "p", ",", 
      "Infinity"}], "]"}]}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPhi]", "/:", 
   RowBox[{
    RowBox[{
     RowBox[{"PD", "[", 
      RowBox[{"p_", "|", 
       RowBox[{"-", "p_"}]}], "]"}], "[", 
     RowBox[{"\[CapitalPhi]", "[", "]"}], "]"}], "/;", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"IndicesOfVBundle", "@", 
       RowBox[{"VBundleOfMetric", "[", "\[Eta]", "]"}]}], ",", "p", ",", 
      "Infinity"}], "]"}]}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"Av", "[", 
    RowBox[{"-", "m"}], "]"}], ",", "M", ",", " ", 
   RowBox[{"PrintAs", "\[Rule]", "\"\<\!\(\*SubscriptBox[
StyleBox[\"A\",
FontWeight->\"Plain\",
FontSlant->\"Italic\"], \"v\"]\)\>\""}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"\[Epsilon]pV", "[", 
    RowBox[{"-", "\[Mu]"}], "]"}], ",", "flat", ",", " ", 
   RowBox[{"PrintAs", "\[Rule]", "\"\<\!\(\*SubscriptBox[
StyleBox[\"A\",
FontWeight->\"Bold\"], \"v\"]\)\>\""}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"\[Epsilon]Avz", "[", "]"}], ",", "flat", ",", " ", 
   RowBox[{"PrintAs", "\[Rule]", "\"\<\!\(\*SubscriptBox[
StyleBox[\"A\",
FontWeight->\"Bold\"], \"vz\"]\)\>\""}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefSplitting", "[", 
    RowBox[{"AAdS", ",", 
     RowBox[{"M", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"z", ",", "flat"}], "}"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SplittingRules", "[", 
    RowBox[{"AAdS", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"-", "z"}], ",", 
          RowBox[{"-", "z"}]}], "]"}], "\[Rule]", 
        RowBox[{"Exp", "[", 
         RowBox[{"2", 
          RowBox[{"A", "[", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"-", "z"}], ",", 
          RowBox[{"-", "\[Mu]"}]}], "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"-", "\[Mu]"}], ",", 
          RowBox[{"-", "z"}]}], "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"-", "\[Mu]"}], ",", 
          RowBox[{"-", "\[Nu]"}]}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"2", 
           RowBox[{"A", "[", "]"}]}], "]"}], 
         RowBox[{"\[Eta]", "[", 
          RowBox[{
           RowBox[{"-", "\[Mu]"}], ",", 
           RowBox[{"-", "\[Nu]"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"z", ",", "z"}], "]"}], "\[Rule]", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"A", "[", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"z", ",", "\[Mu]"}], "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"\[Mu]", ",", "z"}], "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"A", "[", "]"}]}], "]"}], 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Av", "[", "z", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"A", "[", "]"}]}], "]"}], 
         RowBox[{"\[Epsilon]Avz", "[", "]"}]}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Av", "[", 
         RowBox[{"-", "z"}], "]"}], "\[Rule]", 
        RowBox[{"\[Epsilon]Avz", "[", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Av", "[", "\[Mu]", "]"}], "\[Rule]", 
        RowBox[{"\[Epsilon]pV", "[", "\[Mu]", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Av", "[", 
         RowBox[{"-", "\[Mu]"}], "]"}], "\[Rule]", 
        RowBox[{"\[Epsilon]pV", "[", 
         RowBox[{"-", "\[Mu]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "define", " ", "that", " ", "the", " ", "following", " ", "tensor", " ", 
     "depends", " ", "on", " ", "z"}], ",", " ", 
    RowBox[{
    "THIS", " ", "HAS", " ", "TO", " ", "BE", " ", "DEFINED", " ", "BEFORE", 
     " ", "THE", " ", "COMPUTING", " ", "THE", " ", "CURVATURES"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddTensorDependencies", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "g", ",", "A", ",", "TT", ",", "\[CapitalPhi]", ",", "\[Epsilon]pV", 
       ",", "\[Epsilon]Avz"}], "}"}], ",", 
     RowBox[{"{", "z", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "metric", " ", "perturbation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefMetricPerturbation", "[", 
   RowBox[{"g", ",", "h", ",", "\[Epsilon]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefTensorPerturbation", "[", 
   RowBox[{
    RowBox[{"\[Delta]Av", "[", 
     RowBox[{
      RowBox[{"LI", "[", "order", "]"}], ",", 
      RowBox[{"-", "m"}]}], "]"}], ",", 
    RowBox[{"Av", "[", 
     RowBox[{"-", "m"}], "]"}], ",", "M"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefTensorPerturbation", "[", 
   RowBox[{
    RowBox[{"\[Delta]\[Tau]", "[", 
     RowBox[{"LI", "[", "order", "]"}], "]"}], ",", 
    RowBox[{"TT", "[", "]"}], ",", "M"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefTensorPerturbation", "[", 
   RowBox[{
    RowBox[{"\[Delta]\[CapitalPhi]", "[", 
     RowBox[{"LI", "[", "order", "]"}], "]"}], ",", 
    RowBox[{"\[CapitalPhi]", "[", "]"}], ",", "M"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ComputeCurvatureTensors", "[", "AAdS", "]"}], "//", "Timing"}], 
    "//", "First"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "Print", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "Print", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<Splitting curvature tensors computed in \>\"", ",", " ", "time", ",", 
   " ", "\"\< seconds\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.749215073484479*^9, 3.74921516057716*^9}, {
  3.749216778412809*^9, 3.7492167786035843`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Splitting curvature tensors computed in \"\>", 
   "\[InvisibleSpace]", "0.944796`", "\[InvisibleSpace]", "\<\" seconds\"\>"}],
  SequenceForm[
  "Splitting curvature tensors computed in ", 0.944796, " seconds"],
  Editable->False]], "Print",
 CellChangeTimes->{3.749215049832142*^9, 3.749215184497754*^9, 
  3.74921534924312*^9, 3.749215591543488*^9, 3.749216795509514*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Getting", " ", "the", " ", "EOMs"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"a_", "?", "AIndexQ"}], ",", 
      RowBox[{"b_", "?", "AIndexQ"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"CD", "[", "a", "]"}], "@", 
      RowBox[{"Av", "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{"CD", "[", "b", "]"}], "@", 
      RowBox[{"Av", "[", "a", "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lu1", "=", 
     RowBox[{
      SqrtBox[
       RowBox[{"Detg", "[", "]"}]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        RowBox[{"\[CapitalPhi]", "[", "]"}]}]], 
      RowBox[{"F", "[", 
       RowBox[{"m", ",", "n"}], "]"}], 
      RowBox[{"F", "[", 
       RowBox[{
        RowBox[{"-", "m"}], ",", 
        RowBox[{"-", "n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ExpandPerturbation", "@", 
        RowBox[{"Perturbation", "@", "Lu1"}]}], "/.", 
       RowBox[{
        TagBox[
         StyleBox[
          RowBox[{"h", "[", "__", "]"}],
          ShowSpecialCharacters->False,
          ShowStringCharacters->True,
          NumberMarks->True],
         FullForm], "\[Rule]", "0"}]}], "/.", 
      RowBox[{
       RowBox[{"\[Delta]\[Tau]", "[", "_", "]"}], "\[Rule]", "0"}]}], "/.", 
     RowBox[{
      RowBox[{"\[Delta]\[CapitalPhi]", "[", "_", "]"}], "\[Rule]", "0"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"4", " ", 
           SqrtBox[
            InterpretationBox[
             StyleBox[
              OverscriptBox["g", 
               OverscriptBox[
                StyleBox["~",
                 FontColor->RGBColor[0, 0, 0]], 
                StyleBox["~",
                 FontColor->RGBColor[0, 0, 0]]]],
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`Detg[],
             Editable->False]], " "}]], 
         RowBox[{
          RowBox[{"VarD", "[", 
           RowBox[{
            RowBox[{"\[Delta]Av", "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", "m"}], "]"}], ",", "CD"}], 
           "]"}], "[", "%", "]"}]}], "/.", 
        RowBox[{
         TagBox[
          StyleBox[
           RowBox[{"delta", "[", 
            RowBox[{
             RowBox[{"Times", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"LI", "[", "1", "]"}]}], "]"}], ",", 
             RowBox[{"LI", "[", "1", "]"}]}], "]"}],
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True],
          FullForm], "\[Rule]", "1"}]}], "//", "Simplification"}], "//", 
      "ContractMetric"}], "//", "Simplification"}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"CD", "[", "_", "]"}], "@", 
        RowBox[{"\[CapitalPhi]", "[", "]"}]}]}], "]"}], "&"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.749215198460022*^9, 3.7492152044675207`*^9}, {
  3.7492153705231752`*^9, 3.749215374219266*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     InterpretationBox[
      StyleBox["\[CapitalPhi]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[CapitalPhi][],
      Editable->False]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      InterpretationBox[
       StyleBox[
        RowBox[{
         SubscriptBox["\[Del]", "a"], 
         SuperscriptBox["\[Del]", "a"], GridBox[{
           {
            SubscriptBox[
             StyleBox["A",
              FontWeight->"Plain",
              FontSlant->"Italic"], "v"], 
            StyleBox[GridBox[{
               {" "},
               {"m"}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.], {
                   Offset[0.034999999999999996`]}, 
                  Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                   Offset[0.]}}, "RowsIndexed" -> {}}],
             FontSize->Rational[39, 4]]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Center}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.034999999999999996`]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}]}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`CD[-xAct`xPand`a][
        $CellContext`CD[xAct`xPand`a][
         $CellContext`Av[-$CellContext`m]]],
       Editable->False]}], "+", 
     InterpretationBox[
      StyleBox[
       RowBox[{
        SubscriptBox["\[Del]", "a"], 
        SubscriptBox["\[Del]", "m"], GridBox[{
          {
           SubscriptBox[
            StyleBox["A",
             FontWeight->"Plain",
             FontSlant->"Italic"], "v"], 
           StyleBox[GridBox[{
              {"a"},
              {" "}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                  Offset[0.]}}, "RowsIndexed" -> {}}],
            FontSize->Rational[39, 4]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Center}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.034999999999999996`]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}]}],
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`CD[-xAct`xPand`a][
       $CellContext`CD[-$CellContext`m][
        $CellContext`Av[xAct`xPand`a]]],
      Editable->False]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     InterpretationBox[
      StyleBox["\[CapitalPhi]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[CapitalPhi][],
      Editable->False]}]], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "a"], "\[CapitalPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD[-xAct`xPand`a][
     $CellContext`\[CapitalPhi][]],
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       RowBox[{
        SuperscriptBox["\[Del]", "a"], GridBox[{
          {
           SubscriptBox[
            StyleBox["A",
             FontWeight->"Plain",
             FontSlant->"Italic"], "v"], 
           StyleBox[GridBox[{
              {" "},
              {"m"}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                  Offset[0.]}}, "RowsIndexed" -> {}}],
            FontSize->Rational[39, 4]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Center}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.034999999999999996`]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}]}],
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`CD[xAct`xPand`a][
       $CellContext`Av[-$CellContext`m]],
      Editable->False], "-", 
     InterpretationBox[
      StyleBox[
       RowBox[{
        SubscriptBox["\[Del]", "m"], GridBox[{
          {
           SubscriptBox[
            StyleBox["A",
             FontWeight->"Plain",
             FontSlant->"Italic"], "v"], 
           StyleBox[GridBox[{
              {"a"},
              {" "}
             },
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                  Offset[0.]}}, "RowsIndexed" -> {}}],
            FontSize->Rational[39, 4]]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Center}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.034999999999999996`]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}]}],
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`CD[-$CellContext`m][
       $CellContext`Av[xAct`xPand`a]],
      Editable->False]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.749215375633482*^9, 3.7492155921049557`*^9, 
  3.7492167960795507`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Splitting", " ", "the", " ", "EOM"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CD", "[", 
      RowBox[{"-", "a"}], "]"}], "@", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         RowBox[{"\[CapitalPhi]", "[", "]"}]}]], 
       RowBox[{"F", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], ")"}]}], "//", "Simplification"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SplitExpression", "[", 
      RowBox[{"AAdS", ",", " ", 
       RowBox[{"Fun", "\[Rule]", 
        RowBox[{"SeparateMetric", "[", "]"}]}]}], "]"}], "[", "%", "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"now", " ", 
     RowBox[{"let", "'"}], "s", " ", "impose", " ", "the", " ", "gauge", " ", 
     "condition"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"%", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]Avz", "[", "]"}], "\[RuleDelayed]", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"PD", "[", 
          RowBox[{"a_", "?", "AIndexQ"}], "]"}], "@", 
         RowBox[{"\[Epsilon]pV", "[", "b_AIndexQ", "]"}]}], "/;", 
        RowBox[{"a", "\[Equal]", 
         RowBox[{"-", "b"}]}]}], "\[RuleDelayed]", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamD", "[", "z", "]"}], "@", 
        RowBox[{
         RowBox[{"PD", "[", 
          RowBox[{"-", "\[Lambda]"}], "]"}], "@", 
         RowBox[{"\[Epsilon]pV", "[", "\[Lambda]", "]"}]}]}], "\[Rule]", 
       "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"PD", "[", 
         RowBox[{"-", "\[Lambda]"}], "]"}], "@", 
        RowBox[{
         RowBox[{"PD", "[", "\[Mu]", "]"}], "@", 
         RowBox[{"\[Epsilon]pV", "[", "\[Lambda]", "]"}]}]}], "\[Rule]", 
       "0"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.749215493991691*^9, 3.7492155648480873`*^9}, {
   3.74921564663978*^9, 3.7492156468695927`*^9}, {3.7492156859677*^9, 
   3.749215696774135*^9}, {3.7492157403450127`*^9, 3.749215780530777*^9}, {
   3.749215823695323*^9, 3.7492158272794456`*^9}, {3.749215865468614*^9, 
   3.749215892107462*^9}, 3.749215936619935*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    InterpretationBox[
     StyleBox["\[CapitalPhi]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[CapitalPhi][],
     Editable->False]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    InterpretationBox[
     StyleBox[
      RowBox[{
       SubscriptBox["\[Del]", "a"], 
       SuperscriptBox["\[Del]", "a"], GridBox[{
         {
          SubscriptBox[
           StyleBox["A",
            FontWeight->"Plain",
            FontSlant->"Italic"], "v"], 
          StyleBox[GridBox[{
             {"b"},
             {" "}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                 Offset[0.]}}, "RowsIndexed" -> {}}],
           FontSize->Rational[39, 4]]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Center}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.034999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}]}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`CD[-xAct`xPand`a][
      $CellContext`CD[xAct`xPand`a][
       $CellContext`Av[$CellContext`b]]],
     Editable->False], "-", 
    InterpretationBox[
     StyleBox[
      RowBox[{
       SubscriptBox["\[Del]", "a"], 
       SuperscriptBox["\[Del]", "b"], GridBox[{
         {
          SubscriptBox[
           StyleBox["A",
            FontWeight->"Plain",
            FontSlant->"Italic"], "v"], 
          StyleBox[GridBox[{
             {"a"},
             {" "}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                 Offset[0.]}}, "RowsIndexed" -> {}}],
           FontSize->Rational[39, 4]]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Center}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.034999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}]}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`CD[-xAct`xPand`a][
      $CellContext`CD[$CellContext`b][
       $CellContext`Av[xAct`xPand`a]]],
     Editable->False], "+", 
    RowBox[{
     InterpretationBox[
      StyleBox[
       RowBox[{
        SubscriptBox["\[Del]", "a"], "\[CapitalPhi]"}],
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`CD[-xAct`xPand`a][
       $CellContext`\[CapitalPhi][]],
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        InterpretationBox[
         StyleBox[
          RowBox[{
           SuperscriptBox["\[Del]", "a"], GridBox[{
             {
              SubscriptBox[
               StyleBox["A",
                FontWeight->"Plain",
                FontSlant->"Italic"], "v"], 
              StyleBox[GridBox[{
                 {"b"},
                 {" "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                    Offset[0.]}}, "RowsIndexed" -> {}}],
               FontSize->Rational[39, 4]]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Center}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}]}],
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`CD[xAct`xPand`a][
          $CellContext`Av[$CellContext`b]],
         Editable->False]}], "+", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SuperscriptBox["\[Del]", "b"], GridBox[{
            {
             SubscriptBox[
              StyleBox["A",
               FontWeight->"Plain",
               FontSlant->"Italic"], "v"], 
             StyleBox[GridBox[{
                {"a"},
                {" "}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                   Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                    Offset[0.]}}, "RowsIndexed" -> {}}],
              FontSize->Rational[39, 4]]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Center}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.034999999999999996`]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}]}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD[$CellContext`b][
         $CellContext`Av[xAct`xPand`a]],
        Editable->False]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.749215513650116*^9, 3.74921559221325*^9}, 
   3.749215648028324*^9, 3.749215697775672*^9, 3.749215781477919*^9, 
   3.749215831707281*^9, 3.749215893644389*^9, 3.749215939570652*^9, 
   3.7492167980917177`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", 
       InterpretationBox[
        StyleBox["A",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`A[],
        Editable->False]}], "-", 
      InterpretationBox[
       StyleBox["\[CapitalPhi]",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`\[CapitalPhi][],
       Editable->False]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "A"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        xAct`xTensor`ParamD[xAct`SplitExpression`z][
         $CellContext`A[]],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], GridBox[{
            {
             SubscriptBox[
              StyleBox["A",
               FontWeight->"Bold"], "v"], 
             StyleBox[GridBox[{
                {"\[Mu]"},
                {" "}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                   Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                    Offset[0.]}}, "RowsIndexed" -> {}}],
              FontSize->Rational[39, 4]]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Center}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.034999999999999996`]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}]}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        xAct`xTensor`ParamD[xAct`SplitExpression`z][
         $CellContext`\[Epsilon]pV[$CellContext`\[Mu]]],
        Editable->False]}], "-", 
      RowBox[{
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], GridBox[{
            {
             SubscriptBox[
              StyleBox["A",
               FontWeight->"Bold"], "v"], 
             StyleBox[GridBox[{
                {"\[Mu]"},
                {" "}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                   Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                    Offset[0.]}}, "RowsIndexed" -> {}}],
              FontSize->Rational[39, 4]]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Center}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.034999999999999996`]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}]}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        xAct`xTensor`ParamD[xAct`SplitExpression`z][
         $CellContext`\[Epsilon]pV[$CellContext`\[Mu]]],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "\[CapitalPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        xAct`xTensor`ParamD[xAct`SplitExpression`z][
         $CellContext`\[CapitalPhi][]],
        Editable->False]}], "+", 
      InterpretationBox[
       StyleBox[
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], 
         SubscriptBox["\[PartialD]", "z"], GridBox[{
           {
            SubscriptBox[
             StyleBox["A",
              FontWeight->"Bold"], "v"], 
            StyleBox[GridBox[{
               {"\[Mu]"},
               {" "}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.], {
                   Offset[0.034999999999999996`]}, 
                  Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                   Offset[0.]}}, "RowsIndexed" -> {}}],
             FontSize->Rational[39, 4]]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Center}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.034999999999999996`]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}]}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       xAct`xTensor`ParamD[xAct`SplitExpression`z, xAct`SplitExpression`z][
        $CellContext`\[Epsilon]pV[$CellContext`\[Mu]]],
       Editable->False], "+", 
      InterpretationBox[
       StyleBox[
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Lambda]"], 
         SuperscriptBox["\[PartialD]", "\[Lambda]"], GridBox[{
           {
            SubscriptBox[
             StyleBox["A",
              FontWeight->"Bold"], "v"], 
            StyleBox[GridBox[{
               {"\[Mu]"},
               {" "}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.], {
                   Offset[0.034999999999999996`]}, 
                  Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                   Offset[0.]}}, "RowsIndexed" -> {}}],
             FontSize->Rational[39, 4]]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Center}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.034999999999999996`]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}]}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       xAct`xTensor`PD[-$CellContext`\[Lambda]][
        xAct`xTensor`PD[$CellContext`\[Lambda]][
         $CellContext`\[Epsilon]pV[$CellContext`\[Mu]]]],
       Editable->False]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.749215513650116*^9, 3.74921559221325*^9}, 
   3.749215648028324*^9, 3.749215697775672*^9, 3.749215781477919*^9, 
   3.749215831707281*^9, 3.749215893644389*^9, 3.749215939570652*^9, 
   3.749216809908092*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"A", ",", "\[CapitalPhi]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eom", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "''"}], "[", "x", "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "'"}], "[", "x", "]"}], "-", 
      RowBox[{
       RowBox[{"\[CapitalPhi]", "'"}], "[", "x", "]"}]}], ")"}], 
    RowBox[{
     RowBox[{"f", "'"}], "[", "x", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["mn", "2"], 
    RowBox[{"f", "[", "x", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eom", "/.", 
    RowBox[{"f", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"B", "[", "#", "]"}], "]"}], 
        RowBox[{"\[Psi]", "[", "#", "]"}]}], "&"}], ")"}]}]}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Psi]", "[", "x", "]"}], ",", 
        RowBox[{
         RowBox[{"\[Psi]", "'"}], "[", "x", "]"}], ",", 
        RowBox[{
         RowBox[{"\[Psi]", "''"}], "[", "x", "]"}]}], "}"}], ",", 
      "Simplify"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"%", ",", 
       RowBox[{
        RowBox[{"\[Psi]", "'"}], "[", "x", "]"}]}], "]"}], "\[Equal]", "0"}], 
    ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"B", "[", "x", "]"}], "\[Element]", "Reals"}], "}"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Brule", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"DSolve", "[", 
     RowBox[{"%", ",", "B", ",", "x"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["eom", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"A", "[", "x", "]"}]}], "+", 
         RowBox[{"\[CapitalPhi]", "[", "x", "]"}]}], ")"}]}]]], "/.", 
    RowBox[{"{", 
     RowBox[{"f", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"B", "[", "#", "]"}], "]"}], 
         RowBox[{"\[Psi]", "[", "#", "]"}]}], "&"}], ")"}]}], "}"}]}], "/.", 
   "Brule"}], "//", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Psi]", "[", "x", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "'"}], "[", "x", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Psi]", "''"}], "[", "x", "]"}]}], "}"}], ",", "Simplify"}],
     "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.749216768620192*^9, 3.749216772327445*^9}, {
  3.749216819879512*^9, 3.749217184443603*^9}, {3.7492252832458887`*^9, 
  3.749225307229476*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["mn", "2"], " ", 
   RowBox[{"f", "[", "x", "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SuperscriptBox["f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["A", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "-", 
     RowBox[{
      SuperscriptBox["\[CapitalPhi]", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["f", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{
  3.749216925510582*^9, {3.749216974383717*^9, 3.749217185481759*^9}, {
   3.749225286353256*^9, 3.7492253080966387`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Attributes","notfound",
   "\"Symbol \\!\\(\\*RowBox[{\\\"\\\\\\\"DSolveDispatchODE\\\\\\\"\\\"}]\\) \
not found.\"",2,143,12,27601685884622367707,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.749217073709887*^9, 3.749217185488077*^9}, {
  3.7492252864621477`*^9, 3.749225308121544*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"B", "\[Rule]", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"A", "[", "x", "]"}], "2"]}], "+", "0", "+", 
      FractionBox[
       RowBox[{"\[CapitalPhi]", "[", "x", "]"}], "2"]}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.749216925510582*^9, {3.749216974383717*^9, 3.749217185481759*^9}, {
   3.749225286353256*^9, 3.749225308129842*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"\[Psi]", "[", "x", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox["mn", "2"]}], "-", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["A", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       SuperscriptBox["A", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[CapitalPhi]", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "-", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["\[CapitalPhi]", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       SuperscriptBox["A", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       SuperscriptBox["\[CapitalPhi]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Psi]", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{
  3.749216925510582*^9, {3.749216974383717*^9, 3.749217185481759*^9}, {
   3.749225286353256*^9, 3.749225308138283*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["eom"], "Input",
 CellChangeTimes->{{3.749225274560787*^9, 3.749225359878317*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["mn", "2"], " ", 
   RowBox[{"f", "[", "x", "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SuperscriptBox["f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["A", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}], "-", 
     RowBox[{
      SuperscriptBox["\[CapitalPhi]", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["f", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{{3.7492252916391773`*^9, 3.74922536025345*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 755},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 127, 1, 95, "Section"],
Cell[CellGroupData[{
Cell[732, 27, 14025, 396, 2284, "Input"],
Cell[14760, 425, 423, 8, 36, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15220, 438, 3311, 102, 296, "Input"],
Cell[18534, 542, 6254, 180, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24825, 727, 2355, 64, 238, "Input"],
Cell[27183, 793, 6256, 176, 55, "Output"],
Cell[33442, 971, 6935, 188, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40414, 1164, 3058, 99, 238, "Input"],
Cell[43475, 1265, 750, 22, 48, "Output"],
Cell[44228, 1289, 346, 7, 34, "Message"],
Cell[44577, 1298, 498, 15, 64, "Output"],
Cell[45078, 1315, 1326, 37, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46441, 1357, 95, 1, 48, "Input"],
Cell[46539, 1360, 674, 20, 48, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

